# 경기장 이름
WITH TEMP AS (
    SELECT STADIUM_NAME, SCHE_DATE, HOMETEAM_ID, AWAYTEAM_ID, HOME_SCORE, AWAY_SCORE
    FROM KL_SCHEDULE SC JOIN KL_STADIUM ST ON SC.STADIUM_ID = ST.STADIUM_ID
    WHERE HOME_SCORE - AWAY_SCORE >= 3
),
# 홈 팀 이름
HOME AS (
SELECT STADIUM_NAME, SCHE_DATE, TM.TEAM_NAME, HOME_SCORE
FROM TEMP T JOIN KL_TEAM TM ON T.HOMETEAM_ID = TM.TEAM_ID
),
# 원정 팀 이름
AWAY AS (
SELECT STADIUM_NAME, SCHE_DATE, TM.TEAM_NAME, AWAY_SCORE
FROM TEMP T JOIN KL_TEAM TM ON T.AWAYTEAM_ID = TM.TEAM_ID
)

SELECT HOME.STADIUM_NAME, 
       HOME.SCHE_DATE, 
       HOME.TEAM_NAME AS "홈팀명(TEAM_NAME)", 
       AWAY.TEAM_NAME AS "원정팀명(TEAM_NAME)",
       HOME.HOME_SCORE,
       AWAY.AWAY_SCORE
FROM HOME JOIN AWAY ON HOME.SCHE_DATE = AWAY.SCHE_DATE
ORDER BY HOME.SCHE_DATE
